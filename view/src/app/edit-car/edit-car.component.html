<div class="container-fluid" style="padding: 2% 8%">
  <div class="container  text-center w-100 " style="font-family: 'Luckiest Guy', cursive;">
    <h1>Add Car</h1>
  </div>
  <form class="container my-5 p-5 text-bg-dark rounded-5 fw-semibold" [formGroup]="carForm" (ngSubmit)="onSubmit()">
    <div class="row g-3">
      <!--image-->
      <div class="d-block p-3 text-center img-top">
        <img style="max-width: 100%; " [src]="pathImage">
      </div>
      <!--image choose-->
      <div class="row g-0">
        <label for="image" class="col-sm-2 form-label fs-4 required">Files</label>
        <div class="col-sm-10">
          <input class="form-control" type="file" id="image"
                 [ngClass]="{'is-valid':file?.valid,'is-invalid':file?.invalid&&file?.dirty}" formControlName="file"
                 (change)="uploadFile($event)">
          <div class="valid-feedback">
            Looks good!
          </div>
          <div class="invalid-feedback fs-0">
            Required!
          </div>
        </div>
      </div>
      <hr>
      <!--brand and model-->
      <div class="row justify-content-between g-0">
        <div class="col-sm-6 row mb-1 mb-sm-0 g-0">
          <label for="brand" class="col-sm-4 form-label fs-4 required">Brand</label>
          <div class="col-sm-8">
            <select class="form-select"
                    [ngClass]="{'is-valid':brand?.valid,'is-invalid':brand?.invalid&&brand?.dirty}"
                    formControlName="brand" id="brand">
              <option selected value="">Brand</option>
              <option *ngFor="let brand of brandChoose | keyvalue"
                      value="{{brand.key}}">{{brand.value}}</option>
            </select>

            <div class="valid-feedback">
              Looks good!
            </div>
            <div class="invalid-feedback">
              Please choose brand!
            </div>
          </div>
        </div>
        <div class="col-sm-6 row g-0">
          <label for="model" class="col-sm-4 form-label fs-4 text-sm-center required">Model</label>
          <div class="col-sm-8">
            <input type="text" class="form-control" id="model"
                   [ngClass]="{'is-valid':model?.valid,'is-invalid':model?.invalid&&model?.dirty}"
                   formControlName="model" placeholder="Enter model">
            <div class="valid-feedback">
              Looks good!
            </div>
            <div class="invalid-feedback">
              <span [hidden]="!model?.errors?.['maxlength']">Max length 40 symbols!</span>
              <span [hidden]="!model?.errors?.['minlength']">Min length 2 symbols!</span>
              <span [hidden]="!model?.errors?.['required']">Required!</span>
              <span [hidden]="!model?.errors?.['pattern']||(model?.errors?.['minlength']||model?.errors?.['maxlength']||
                               model?.errors?.['required'])">
                Valid characters: numbers, latin alphabet characters, space, and hyphen!
              </span>
            </div>
          </div>
        </div>
      </div>
      <hr class="mb-0">

      <div class="col-sm-6 row g-0 gy-3">
        <!--body-->
        <div class="row g-0">
          <label for="bodyType" class="col-sm-6 form-label fs-4 required">Body</label>
          <div class="col-sm-6">
            <select class="form-select"
                    [ngClass]="{'is-valid':bodyType?.valid,'is-invalid':bodyType?.invalid&&bodyType?.dirty}"
                    formControlName="bodyType" id="bodyType">
              <option selected value="">Body</option>
              <option *ngFor="let bodyType of bodyTypes | keyvalue" value="{{bodyType.key}}">{{bodyType.value}}</option>
            </select>
            <div class="valid-feedback">
              Looks good!
            </div>
            <div class="invalid-feedback">
              Please choose body!
            </div>
          </div>
        </div>
        <hr>

        <!--transmission-->
        <div class="row g-0">
          <label for="bodyType" class="col-sm-6 form-label fs-4 required">Transmission</label>
          <div class="col-sm-6 d-block d-sm-flex d-md-block d-xl-flex justify-content-between">
            <div *ngFor="let transmission of transmissionTypes|keyvalue;let i = index" class="form-check form-check-inline
             m-0 ms-2 ms-sm-0 ms-md-2 ms-xl-0">
              <input class="form-check-input mt-2" type="radio" formControlName="transmissionType"
                     [value]="transmission.key" [id]="transmission">
              <label class="form-check-label fs-5" [for]="transmission">
                {{transmission.value}}
              </label>
            </div>
          </div>
        </div>
        <hr>

        <!--engine size-->
        <div class="row g-0">
          <label for="engine" class="col-sm-6 form-label fs-4 required">Engine size</label>
          <div class="col-sm-6">
            <input type="number" step="0.1" class="form-control " id="engine" min="0.1" max="10"
                   [ngClass]="{'is-valid':engineSize?.valid,'is-invalid':engineSize?.invalid&&engineSize?.dirty}"
                   placeholder="Engine size" formControlName="engineSize">
            <div class="valid-feedback">
              Looks good!
            </div>
            <div class="invalid-feedback">
              <span [hidden]="!engineSize?.errors?.['max']">Max engine size 10!</span>
              <span [hidden]="!engineSize?.errors?.['min']">Min engine size 0.1!</span>
              <span [hidden]="!engineSize?.errors?.['required']">Required!</span>
            </div>
          </div>
        </div>
        <hr>

        <!--year-->
        <div class="row g-0">
          <label for="engine" class="col-sm-6 form-label fs-4 required">Year</label>
          <div class="col-sm-6">
            <input type="number" class="form-control" min="1880" max="2100" id="year" [class.is-valid]="year?.valid"
                   [class.is-invalid]="year?.invalid&&year?.dirty" formControlName="year"
                   placeholder="Year">
            <div class="valid-feedback">
              Looks good!
            </div>
            <div class="invalid-feedback">
              <span [hidden]="!year?.errors?.['max']">Max year 2100!</span>
              <span [hidden]="!year?.errors?.['min']">Min year 1800!</span>
              <span [hidden]="!year?.errors?.['required']">Required!</span>
            </div>
          </div>
        </div>
        <hr>
      </div>

      <!--short description-->
      <div class="row g-0">
        <label for="shortDescription" class="form-label fs-4 required">Short description:</label>
        <textarea class="form-control col-12" id="shortDescription" rows="3"
                  [class.is-valid]="shortDescription?.valid"
                  [class.is-invalid]="shortDescription?.invalid&&shortDescription?.dirty"
                  formControlName="shortDescription" placeholder="Short description"></textarea>
        <div class="valid-feedback">
          Looks good!
        </div>
        <div class="invalid-feedback">
          <span [hidden]="!shortDescription?.errors?.['maxlength']">Max length 150 symbols!</span>
          <span [hidden]="!shortDescription?.errors?.['minlength']">Min length 25 symbols!</span>
          <span [hidden]="!shortDescription?.errors?.['required']">Required!</span>
        </div>
      </div>
      <hr>
      <!--description-->
      <div class="row g-0">
        <label for="description" class="form-label fs-4 required">Description:</label>
        <textarea class="form-control" id="description" rows="5"
                  [class.is-valid]="description?.valid" [class.is-invalid]="description?.invalid&&description?.dirty"
                  formControlName="description" placeholder="Description"></textarea>
        <div class="valid-feedback">
          Looks good!
        </div>
        <div class="invalid-feedback">
          <span [hidden]="!description?.errors?.['maxlength']">Max length 5000 symbols!</span>
          <span [hidden]="!description?.errors?.['minlength']">Min length 50 symbols!</span>
          <span [hidden]="!description?.errors?.['required']">Required!</span>
        </div>
      </div>
      <hr>
      <!--options list-->
      <div formArrayName="optionalList" class="row g-0">
        <span class="fs-4">
          Options:
        </span>

        <div class="row g-0">
          <div *ngFor="let option of optionalList.controls;let i = index"
               class="col-md-6 col-xl-4 m-0">
            <label>
              <button type="button" (click)='dropOption(i)' class="btn-close btn-close-white btn-sm"
                      aria-label="Close">
              </button>

              {{option.value}}
            </label>
          </div>
        </div>
      </div>

      <div class="row g-0">
        <div class="col-sm-6 row g-0 gy-2 ps-0">

          <div class="col-sm-10 col-xl-8 col-xl-6"
               [class.is-valid]="optional?.valid&&optional?.value!==''&&optional?.value!==null"
               [class.is-invalid]="optional?.invalid&&optional?.dirty">
            <input #optionalInput class="form-control" id="option" type="text"
                   [class.is-valid]="optional?.valid&&optional?.value!==''&&optional?.value!==null"
                   [class.is-invalid]="optional?.invalid&&optional?.dirty"
                   formControlName="optional" placeholder="Add option" (keydown.enter)="addOption()">
            <div class="valid-feedback">
              Looks good!
            </div>
            <div class="invalid-feedback">
              <span [hidden]="!optional?.errors?.['maxlength']">Max length 25 symbols!</span>
              <span [hidden]="!optional?.errors?.['minlength']">Min length 2 symbols!</span>
              <span
                [hidden]="!optional?.errors?.['pattern']||(optional?.errors?.['minlength']||optional?.errors?.['maxlength'])">
                Valid characters: numbers, latin alphabet characters, space, and hyphen!
              </span>
            </div>
          </div>

          <div class="col-sm-2 d-flex justify-content-end">
            <div class="text-center">
              <button type="button" class="btn btn-success" (click)="addOption()"
                      [disabled]="optional?.invalid||optional?.value===''||optional?.value===null">
                <img src="assets/icons/plus-solid.svg" width="21">
              </button>
            </div>
          </div>

        </div>
      </div>

      <hr>
      <!--buttons-->
      <div class="d-flex justify-content-end p-0">
        <button type="button" (click)="onReset()" class="btn btn-danger col-auto me-3"
                (mouseover)="textResetCarButton=true"
                (mouseleave)="textResetCarButton=false">
          <span [hidden]="textResetCarButton===true">
                <img src="assets/icons/xmark-solid.svg" width="16">
          </span>
          <span [hidden]="textResetCarButton===false">Reset</span><span class="sr-only">(current)</span>
        </button>

        <button type="submit" class="btn btn-success col-auto" [disabled]="!carForm.valid"
                (mouseover)="textAddCarButton=true"
                (mouseleave)="textAddCarButton=false">
          <span [hidden]="textAddCarButton===true">
                <img src="assets/icons/pen-solid.svg" width="21">
          </span>
          <span [hidden]="textAddCarButton===false">Edit car</span><span class="sr-only">(current)</span>
        </button>
      </div>
    </div>
  </form>
</div>
